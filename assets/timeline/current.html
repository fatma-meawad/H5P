<head>
    <script src="https://kit.fontawesome.com/de4dc6c465.js" crossorigin="anonymous"></script>
</head>
<style>
    #chartdiv {
        width: 100%;
        height: 500px;
    }

    .icon-grid {
        gap: 20px;
        margin-top: 10px;
    }

    .icon-item {
        font-size: 30px;
        padding: 10px;
        vertical-align: bottom;

    }

    .icon-img {
        padding: 10px;
        width: 50px;
        height: 50px;
        vertical-align: top;
    }

    .container {
        width: 100%;
        height: 100px;
        display: inline-block;
        vertical-align: top;
        padding: 10px;
        border-left: 1px solid #ddd;
        background-color: #f9f9f9;
    }


    .task-title1 {
        font-size: 16px;
        font-weight: bold;
        padding: 5px;
    }

    .task-title2 {
        font-size: 14px;
        margin-bottom: 10px;
        padding: 5px;
    }

    .task-dates {
        font-size: 12px;
        color: #666;
        margin-bottom: 10px;
        padding: 10px;
    }

    .module-panel {
        font-family: 'Roboto', Arial, sans-serif;
        background-color: hsla(0, 15%, 95%, 0.506);

        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        padding: 10px;
        max-width: 100%;
        width: 100%;
        transition: box-shadow 0.3s ease;
    }

    .module-panel:hover {
        box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
    }


    .info-row {
        display: flex;
        align-items: center;
        margin-bottom: 12px;
        color: #555;
    }

    .info-row svg {
        width: 20px;
        height: 20px;
        margin-right: 8px;
    }

    .badges {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 16px;
    }

    .badge {
        background-color: #e6f0ff;
        color: #0066cc;
        padding: 4px 8px;
        border-radius: 16px;
        font-size: 14px;
    }

    .practices {
        margin-bottom: 16px;
    }

    .practices h3,
    .description h3 {
        font-size: 18px;
        color: #444;
        margin-bottom: 8px;
    }

    .practices ul {
        padding-left: 20px;
        color: #555;
    }

    .description {
        border-top: 1px solid #eee;
        padding-top: 16px;
        margin-top: 16px;
    }

    .description p {
        color: #555;
        line-height: 1.6;
    }

    .learn-more {
        background-color: #0066cc;
        color: white;
        border: none;
        padding: 10px 16px;
        border-radius: 4px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .learn-more:hover {
        background-color: #0052a3;
    }
</style>

<!-- Resources -->
<script src="https://cdn.amcharts.com/lib/5/index.js"></script>
<script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
<script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>

<!-- Chart code -->
<script>

    let week = 0;
    let dIndex = 0;

    am5.ready(function () {


        // Create root element
        // https://www.amcharts.com/docs/v5/getting-started/#Root_element
        var root = am5.Root.new("chartdiv");
        root.dateFormatter.setAll({
            dateFormat: "yyyy-MM-dd",
            dateFields: ["valueX", "openValueX"]
        });


        // Set themes
        // https://www.amcharts.com/docs/v5/concepts/themes/
        root.setThemes([
            am5themes_Animated.new(root)
        ]);


        // Create chart
        // https://www.amcharts.com/docs/v5/charts/xy-chart/
        var chart = root.container.children.push(am5xy.XYChart.new(root, {
            panY: false,
            wheelX: "panX",
            wheelY: "zoomX",
            paddingLeft: 0,
            layout: root.verticalLayout
        }));



        // Add legend
        // https://www.amcharts.com/docs/v5/charts/xy-chart/legend-xy-series/
        var legend = chart.children.push(am5.Legend.new(root, {
            centerX: am5.p50,
            x: am5.p50
        }))

        var colors = chart.get("colors");
        var categories = [

            { category: "Tutorials" },
            { category: "Tasks " },
            { category: "Requirements \n & planning" },
            { category: "Sprint Work \n & Demos" },
            { category: "Modules" }
            // { category: "Topics" }
        ];

        all_data = [];

        all_data[0] = [{
            category:
                categories[0].category,
            icons: [
                'fa fa-git',
                'fa fa-github',
                'fa fa-slack',

            ],
            task: "Git Basics Tutorial",
            link: "https://fuzzy-journey-v7y6oy5.pages.github.io/gitflow/",
            start: new Date("2024-09-16").getTime(),
            end: new Date("2024-09-21").getTime(),
            columnSettings: {
                fill: am5.Color.brighten(colors.getIndex(1), 0)
            },


        }
            ,
        {
            category: categories[1].category,
            icons: [
                'fa fa-git',
                'fa fa-github',
                'fa fa-medal',

            ],
            imgs: [
                '../imgs/gbasics-3d.png'
            ],

            task: "Git Task: Engineer's Portfolio üèÖ",
            link: "https://opit.instructure.com/courses/293/assignments/1273?module_item_id=8766",
            start: new Date("2024-09-16").getTime(), end: new Date("2024-09-21").getTime(), columnSettings: {
                fill: am5.Color.brighten(colors.getIndex(7), 0)
            }
        }];


        all_data[1] = [{
            category: categories[0].category,
            icons: [
                'fa fa-git',
                'fa fa-github',
                'fa-brands fa-node',
                'fa-brands fa-react',

            ],
            imgs: [
                '../visual-studio-code.png',
                '../postgresql.png',
                '../postman.png'


            ],
            task: "PERN CRUD Tutorial", start: new Date("2024-09-23").getTime(), end: new Date("2024-09-30").getTime(), columnSettings: {
                fill: am5.Color.brighten(colors.getIndex(1), 0)
            }
        }, {
            category: categories[2].category,
            icons: [
            ],
            imgs: [
            ],
            task: "User Stories & Moqups", start: new Date("2024-09-23").getTime(), end: new Date("2024-09-27").getTime(), columnSettings: {
                fill: am5.Color.brighten(colors.getIndex(3), 0)
            }
        }]

        all_data[2] = [{
            category: categories[1].category,
            icons: [
                'fa fa-git',
                'fa fa-github',
                'fa-solid fa-medal',
                'fa-solid fa-database',
                'fa-solid fa-server',
                'fa-brands fa-node',
                'fa-brands fa-react',
                'fa-solid fa-people-group'

            ],
            task: "App Enhancement Task üèÖüèÖ", start: new Date("2024-09-30").getTime(), end: new Date("2024-10-12").getTime(), columnSettings: {
                fill: am5.Color.brighten(colors.getIndex(7), 0),
            }
        }, {
            category: categories[2].category,
            icons: [
            ],
            imgs: [
            ],
            task: "Gitflow & Kanban boards", start: new Date("2024-09-30").getTime(), end: new Date("2024-10-5").getTime(), columnSettings: {
                fill: am5.Color.brighten(colors.getIndex(3), 0)
            }
        }

        ]

        all_data[3] = [

            {

                category: categories[2].category, task: "", start: new Date("2024-10-07").getTime(), end: new Date("2024-10-26").getTime(), columnSettings: {

                    //fill: am5.color(0xFFFFFF),  // White fill
                    fill: am5.Color.brighten(colors.getIndex(3), 0),
                    strokeWidth: 0.5,             // Border width
                    strokeOpacity: am5.color(0x000000) // Border color (black in this example)
                }

            },
            {

                category: categories[2].category, task: "Project on Moqups", start: new Date("2024-10-07").getTime(), end: new Date("2024-10-13").getTime(), columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(3), 0)
                }
            }
        ]

        all_data[4] = [
            {
                category: categories[2].category, task: "Sync with project setup & Integrate", start: new Date("2024-10-14").getTime(), end: new Date("2024-10-19").getTime(), columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(3), 0)
                }
            }]

        all_data[5] = [

            {
                category: categories[2].category, task: "Refine & submit Sprint 1 plan", start: new Date("2024-10-21").getTime(), end: new Date("2024-10-25").getTime(), columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(3), 0)
                }
            }]

        all_data[6] = [

            {
                category: categories[3].category, task: "Sprint 0 Active", start: new Date("2024-11-4").getTime(), end: new Date("2024-11-16").getTime(), columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(8), 1)
                }
            }]


        all_data[8] = [

            {
                category: categories[2].category, task: "Sprint 2 plan & Retro", start: new Date("2024-11-18").getTime(), end: new Date("2024-11-23").getTime(), columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(3), 0)
                }
            }//,

            /* {
                 category: categories[1].category, task: "Testing task", start: new Date("2024-11-11").getTime(), end: new Date("2024-11-30").getTime(), columnSettings: {
                     fill: am5.Color.brighten(colors.getIndex(7), 0)
                 }
             }*/
        ]
        all_data[7] = [
            {
                category: categories[0].category, task: "Automated Testing tutorial", start: new Date("2024-11-4").getTime(), end: new Date("2024-11-16").getTime(), columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(1), 0)
                }
            }]

        all_data[9] = [
            {
                category: categories[3].category, task: "Sprint 1 Active", start: new Date("2024-11-25").getTime(), end: new Date("2024-12-7").getTime(), columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(8), 1)
                }
            }
            // Add more tasks here
        ]

        all_data[12] = [
            {

                category: categories[3].category, task: "Group Evaluations", start: new Date("2024-12-10").getTime(), end: new Date("2024-12-14").getTime(), columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(8), 1)
                }
            }
        ]


        const topics = [
            "Into & process & VCS & scrumban",
            "UserStories & moqups & BBD & Restful & QA",
            "Planning, project management & gitflow & how to review",
            "Project specs, Agile Modelling:ERD and API Design",
            "MVC, project setup, quality:CC",
            "AOB backlog, in-class Sprint planning & Game",
            "AOB sprint progress",
            "Automated testing and its types, & TDD",
            "Retrospective & Architecture Dependencies & S-2 planning",
            "AOB progress",
            "Deeper into CC, reflect on processes Sprint 2 Active",
            "Project review & Demos & Retros",
            "Ceremonies and group interview"
        ];

        const descriptions = [
            "The motivation for SE, the software crisis and the agile movement with a focus on Scrum. A quick intro to version control. Practice: Tutorial and git task practice.",
            "Requirements Engineering with a focus on User stories and acceptance tests. The PERN technology stack.",
            "An introduction to planning in scrum and Kanban boards in Github. Practice Git Flow and review practices.",
            "Project requirements and agile modelling techniques starting with ERD and API design. The first assessment submission.",
            "Retrospective: Understanding the most common architectural patterns in full stack web applications and the key principles of Clean Code.",
            "Refining and Reviewing project requirements. An all on board sprint planning for Sprint .",
            "No new content in Week 7 but, Sprint 1 has started.",
            "Automated Testing (unit, integration and E2E testing. A discussion of TDD. This is the second week of sprint 1.",
            "Decoupling Components, dependency analysis and components diagrams. Sprint 2 plan discussion.",
            "Refactoring techniques and  Sprint 2 Progress discussion.",
            "Best Practices in Security, design and development. ",
            "Retrospective and reflecting on software processes.",
            "Group assessments and final announcements of rewards."
        ];
        const m_titles = [
            "Module 1: An Introduction & Team Onboarding",
            "Module 2: Agile Requirements & Tech Onboarding",
            "Module 3: Agile Planning and Project Management",
            "Module 4: Agile Modelling & Project Requirements",
            "Module 5: MVC and Clean Code Principles",
            "Module 6: Requirements Review & Sprint 1 planning",
            "Module 7: Sprint 1 - Active",
            "Module 8: Automated Testing & Sprint 1 Active",
            "Module 9: Dependency Analysis & Sprint 2 Planning",
            "Module 10: Managing Technical Dept & Sprint 2 Active",
            "Module 11: Best Practices & Sprint 2 Active",
            "Module 12: Project review and Retrospective",
            "Module 13: Group assessments & Ceremony and Badges"
        ];

        var data = []


        var startDate = new Date("2024-09-16T00:00:00");
        for (var i = 0; i < 13; i++) {
            var fromDate = new Date(startDate);
            fromDate.setDate(fromDate.getDate() + (i * 7));
            var toDate = new Date(fromDate);
            toDate.setDate(toDate.getDate() + 6);

            data.push({
                category: "Modules",
                task: "Week " + (i + 1),
                start: fromDate.getTime(),
                end: toDate.getTime(),
                m_title: m_titles[i],
                descrip: descriptions[i],
                columnSettings: {
                    fill: am5.Color.brighten(colors.getIndex(13), 0)
                }
            });

            if (all_data[i])
                for (var k = 0; k < all_data[i].length; k++) {
                    all_data[i][k].m_title = m_titles[i];
                    all_data[i][k].descrip = descriptions[i];
                    data.push(all_data[i][k]);
                }


        }


        // Create axes
        // https://www.amcharts.com/docs/v5/charts/xy-chart/axes/

        var yRenderer = am5xy.AxisRendererY.new(root, {
            minorGridEnabled: true,
            inversed: true,


        });
        yRenderer.grid.template.set("location", 0);
        yRenderer.labels.template.set("fontSize", 9);

        var yAxis = chart.yAxes.push(
            am5xy.CategoryAxis.new(root, {
                categoryField: "category",
                renderer: yRenderer,
                labels: {
                    template: {
                        fontSize: 8
                    }
                }
            })
        );


        yAxis.data.setAll(categories);



        var xAxis = chart.xAxes.push(
            am5xy.DateAxis.new(root, {

                baseInterval: { timeUnit: "day", count: 1 },
                renderer: am5xy.AxisRendererX.new(root, {
                    strokeOpacity: 0.1,
                    minorGridEnabled: true,
                    minGridDistance: 80
                })
            })
        );


        // Add series
        // https://www.amcharts.com/docs/v5/charts/xy-chart/series/
        var series = chart.series.push(am5xy.ColumnSeries.new(root, {
            xAxis: xAxis,
            yAxis: yAxis,
            openValueXField: "start",
            valueXField: "end",
            categoryYField: "category",
            sequencedInterpolation: true,

        }));

        series.bullets.push(function (root, series, dataItem) {
            return am5.Bullet.new(root, {
                locationX: 0.5,
                sprite: am5.Label.new(root, {
                    text: dataItem.dataContext.task,
                    fontSize: "8px",
                    fill: am5.color(0xffffff),
                    centerX: am5.p50,
                    centerY: am5.p50,
                    //maxWidth: 120, // Adjust the width as needed
                    wrap: true,
                    truncate: false,
                    oversizedBehavior: "wrap",
                    textAlign: "center"
                })
            });
        });

        series.columns.template.setAll({
            templateField: "columnSettings",
            strokeOpacity: 0
            //tooltipText: "{task}:\n[bold]{openValueX}[/] - [bold]{valueX}[/]"
        });

        series.columns.template.events.on("click", function (ev) {
            let dataItem = ev.target.dataItem.dataContext;
            displayTaskInfo(dataItem);
        });

        //console.log(data);
        series.data.setAll(data);
        // Get current month range
        var now = new Date();
        var startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
        var endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0);

        // Zoom to the current month
        xAxis.events.once("datavalidated", function () {
            xAxis.zoomToDates(startOfMonth, endOfMonth);
        });






        // Add scrollbars
        var scrollbarX = chart.set("scrollbarX", am5.Scrollbar.new(root, { orientation: "horizontal" }));




        var playButton = chart.children.push(am5.Button.new(root, {
            label: am5.Label.new(root, {
                text: "+"
            }),
            width: 50,
            height: 50,
            marginRight: 20,
            fill: am5.color(0x000000),
            fillOpacity: 0
        }));

        var stepButton = chart.children.push(am5.Button.new(root, {
            label: am5.Label.new(root, {
                text: ">"
            }),
            width: 50,
            height: 50,
            marginRight: 20,
            fill: am5.color(0x000000),
            fillOpacity: 0,
            position: "left"

        }));


        stepButton.events.on("click", function () {
            if (stepButton.get("active")) {
                slider.set("start", slider.get("start") + 0.1);
            } else {
                series.data.clear();
                week = 0;
                stepButton.set("active", true);
                slider.set("start", 0);
                slider.animate({
                    key: "start",
                    to: 1,
                    duration: 15000 * (1 - slider.get("start"))
                });
            }
        });


        playButton.events.on("click", function () {
            if (week == 0)
                series.data.clear();
            updateSeriesData();

        });
        var slider = chart.children.push(am5.Slider.new(root, {
            orientation: "horizontal",
            start: 0,
            centerY: am5.p50,
            visible: true
        }));

        slider.on("start", function (start) {
            if (start === 1) {
                stepButton.set("active", false);
            }
        });

        slider.events.on("rangechanged", function () {
            if (slider.get("start") > (week / data.length)) {
                updateSeriesData();
            }
        });

        function updateSeriesData() {

            if (week < data.length) {
                let dataItem = data[week];
                console.log(week, data.length, dataItem);
                series.data.push(dataItem);
                displayTaskInfo(dataItem);
                week++;
                while (week < data.length) {
                    dataItem = data[week];
                    if (dataItem.category == "Modules")
                        break;
                    else {
                        series.data.push(dataItem);
                        displayTaskInfo(dataItem);
                        week++;
                    }
                }
            }
            else
                week = 0;
            playButton.set("active", true);

        }

        //xAxis.zoomToDates(new Date(data[0].start), new Date(data[data.length - 1].end));






        function displayTaskInfo(dataItem) {
            const taskInfo = document.getElementById("taskinfo");
            const iconGrid = document.getElementById('iconGrid');
            //const imgGrid = document.getElementById('imgGrid');

            // Clear previous icons
            iconGrid.innerHTML = '';
            //imgGrid.innerHTML = '';

            // Add new icons if present
            if (dataItem.icons && Array.isArray(dataItem.icons)) {
                dataItem.icons.forEach(icon => {
                    const iconElement = document.createElement('i');
                    iconElement.className = icon + ' icon-item';
                    iconGrid.appendChild(iconElement);
                });
            }

            if (dataItem.imgs && Array.isArray(dataItem.imgs)) {
                dataItem.imgs.forEach(icon => {
                    const iconElement = document.createElement('img');
                    iconElement.className = 'icon-img';
                    iconElement.src = icon;
                    iconGrid.appendChild(iconElement);
                });
            }
            var task = "";
            if (dataItem.link)
                task = "<a href='" + dataItem.link + "'>" + dataItem.task + "</a>"
            else
                task = dataItem.task;

            taskInfo.innerHTML = `
        <div class="task-title1">${dataItem.m_title}</div>
        <div class="task-title2">${dataItem.descrip}</div>
        <div class="task-title2">${task}</div>
      
    `;
        }




        // Make stuff animate on load
        // https://www.amcharts.com/docs/v5/concepts/animations/
        series.appear(100);
        chart.appear(1000, 100);




        var milestoneDate = new Date("2024-10-12").getTime();  // Adjust milestone date here
        var milestone = xAxis.makeDataItem({
            value: milestoneDate
        });

        xAxis.createAxisRange(milestone);

        milestone.get("grid").setAll({
            stroke: am5.color(0xff0000),
            strokeWidth: 6,
            tooltipText: "Assessment 1 15%"
        });


        milestoneDate = new Date("2024-10-26").getTime();  // Adjust milestone date here
        milestone = xAxis.makeDataItem({
            value: milestoneDate
        });

        xAxis.createAxisRange(milestone);

        milestone.get("grid").setAll({
            stroke: am5.color(0xff0000),
            strokeWidth: 6,
            tooltipText: "Assessment 2 15%"
        });


        milestoneDate = new Date("2024-11-16").getTime();  // Adjust milestone date here
        milestone = xAxis.makeDataItem({
            value: milestoneDate
        });

        xAxis.createAxisRange(milestone);

        milestone.get("grid").setAll({
            stroke: am5.color(0xff0000),
            strokeWidth: 6,
            tooltipText: "Assessment 3 30%"
        });


        milestoneDate = new Date("2024-12-7").getTime();  // Adjust milestone date here
        milestone = xAxis.makeDataItem({
            value: milestoneDate
        });

        xAxis.createAxisRange(milestone);

        milestone.get("grid").setAll({
            stroke: am5.color(0xff0000),
            strokeWidth: 6,
            tooltipText: "Assessment 4 40%"
        });


    }); // end am5.ready()





</script>

<!-- HTML -->

<div></div>
<table class="module-panel">
    <td>
        <div id="taskinfo">
            <!-- Dynamic content will be inserted here -->
        </div>
        <div id="iconGrid">
            <!-- Icons will be inserted here -->
        </div>
    </td>

</table>
</div>
<div id="chartdiv"></div>